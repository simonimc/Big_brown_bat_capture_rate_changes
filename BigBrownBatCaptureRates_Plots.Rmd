---
title: "Simonis_et_al_2022_Oceologia_BigBrownBatCaptureRates_Plots"
author: "Molly Simonis"
date: "10/11/2022"
output: html_document
---

This RMD is for creating plots associated with the Simonis et al 2022 Oceologia publication. This RMD also includes additional analyses for Bayes R^2 values and conditional effects interaction combinations. Please note: analyses for Bayesian models and conditional effects must be completed prior to using this code (see R script entitled 'Simonis_et_al_2023_Oceologia_BigBrownBatCaptureRates).

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
library(plyr)
library(emmeans)
library(brms)
library(magrittr)
library(purrr)
library(forcats)
library(modelr)
library(ggdist)
library(tidybayes)
library(rstan)
library(ggrepel)
library(RColorBrewer)
library(gganimate)
library(ggridges)
library(wesanderson)
library(distributional)
library(fishualize)
library(patchwork)
library(ggnewscale)
library(ggeffects)
```

load previously saved environments from cluster analyses
```{r}
#if full environment cannot load, split cluster code from the script 'EPFU_count_Bayes_ClusterScript.R' into two, separate scripts and save environments from each script individually. Then create plots at different times for each environment for this project

load('BigBrownBat_CaptureRate_Bayes_Cluster.RData')
```


look at convergence plots (Figs S3-S6)
```{r}
#for all adults
plot(adult_count_mod1)
plot(adult_count_mod2)

#for females only
plot(fem_count_mod1)
plot(fem_count_mod2)
```

Get your bayes R2s
```{r}
#for adult models
bayes_R2(adult_count_mod1) %>% 
  round(digits = 2)

bayes_R2(adult_count_mod2) %>% 
  round(digits = 2)

#for female-only models
bayes_R2(fem_count_mod1) %>% 
  round(digits = 2)


bayes_R2(fem_count_mod2) %>% 
  round(digits = 2)

```

Get draws (posterior samples) for all models
```{r}
#adult first model with space/full interx term
draws_adult1<- as.data.frame(adult_count_mod1 %>%
  emmeans( ~ disease_time_step*sex*county_centroid_lat, data = adult_EPFUcount) %>%
  gather_emmeans_draws())

draws_adult1$.value_bktrns<- 10^draws_adult1$.value


#adult second model with full interx term
draws_adult2<- as.data.frame(adult_count_mod2 %>%
  emmeans( ~ disease_time_step*sex*lat_cat, data = adult_EPFUcount) %>%
  gather_emmeans_draws())

draws_adult2$.value_bktrns<- 10^draws_adult2$.value


#female-only first model
draws_fem1<- as.data.frame(fem_count_mod1 %>%
  emmeans( ~ disease_time_step*repstat*county_centroid_lat, data = fem_EPFUcount) %>%
  gather_emmeans_draws())

draws_fem1$.value_bktrns<- 10^draws_fem1$.value


#female-only second model
draws_fem2<- as.data.frame(fem_count_mod2 %>%
  emmeans( ~ disease_time_step*repstat*lat_cat, data = fem_EPFUcount) %>%
  gather_emmeans_draws())

draws_fem2$.value_bktrns<- 10^draws_fem2$.value


```


get slopes and predictions for first adult model and first female-only model with latitude (for Supplementary Table S1)
```{r}
#adult first model
emtrends(adult_count_mod1, ~sex*disease_time_step, var = 'county_centroid_lat')

adult_count_mod1_emt<- as.data.frame(emtrends(adult_count_mod1, ~sex*disease_time_step, var = 'county_centroid_lat'))

adult_count_mod1_pred<- as.data.frame(ggemmeans(adult_count_mod1, terms = c('county_centroid_lat', 'disease_time_step', 'sex'), type = 'fe'))


#female-only first model
emtrends(fem_count_mod1, ~repstat*disease_time_step, var = 'county_centroid_lat')

fem_count_mod1_emt<- as.data.frame(emtrends(fem_count_mod1, ~repstat*disease_time_step, var = 'county_centroid_lat'))

fem_count_mod1_pred<- as.data.frame(ggemmeans(fem_count_mod1, terms = c('county_centroid_lat', 'disease_time_step', 'repstat'), type = 'fe'))
```

get full emmeans means and credible intervals for second adult models for all interaction combinations (for Supplementary Tables S2)
```{r}
#get full posterior means for all combos
ems_adult2<-emmeans(adult_count_mod2, ~disease_time_step*lat_cat*sex)
summary(ems_adult2, point.est = mean)

ems_adult2_df<- as.data.frame(summary(ems_adult2, point.est = mean))
ems_adult2_df$emmean.bktrns<- 10^ems_adult2_df$emmean
ems_adult2_df$lower.HPD.bktrns<- 10^ems_adult2_df$lower.HPD
ems_adult2_df$upper.HPD.bktrns<- 10^ems_adult2_df$upper.HPD



#posterior means for sex*lat_cat
ems_adult2b<-emmeans(adult_count_mod2, ~lat_cat*sex)
summary(ems_adult2b, point.est = mean)

ems_adult2b_df<- as.data.frame(summary(ems_adult2b, point.est = mean))
ems_adult2b_df$emmean.bktrns<- 10^ems_adult2b_df$emmean
ems_adult2b_df$lower.HPD.bktrns<- 10^ems_adult2b_df$lower.HPD
ems_adult2b_df$upper.HPD.bktrns<- 10^ems_adult2b_df$upper.HPD


#posterior means for sex only
ems_adult2c<-emmeans(adult_count_mod2, ~sex)
summary(ems_adult2c, point.est = mean)

ems_adult2c_df<- as.data.frame(summary(ems_adult2c, point.est = mean))
ems_adult2c_df$emmean.bktrns<- 10^ems_adult2c_df$emmean
ems_adult2c_df$lower.HPD.bktrns<- 10^ems_adult2c_df$lower.HPD
ems_adult2c_df$upper.HPD.bktrns<- 10^ems_adult2c_df$upper.HPD



#posterior means for sex*disease_time_step only
ems_adult2d<-emmeans(adult_count_mod2, ~sex*disease_time_step)
summary(ems_adult2d, point.est = mean)

ems_adult2d_df<- as.data.frame(summary(ems_adult2d, point.est = mean))
ems_adult2d_df$emmean.bktrns<- 10^ems_adult2d_df$emmean
ems_adult2d_df$lower.HPD.bktrns<- 10^ems_adult2d_df$lower.HPD
ems_adult2d_df$upper.HPD.bktrns<- 10^ems_adult2d_df$upper.HPD


#posterior means for lat_cat only
ems_adult2e<-emmeans(adult_count_mod2, ~lat_cat)
summary(ems_adult2e, point.est = mean)

ems_adult2e_df<- as.data.frame(summary(ems_adult2e, point.est = mean))
ems_adult2e_df$emmean.bktrns<- 10^ems_adult2e_df$emmean
ems_adult2e_df$lower.HPD.bktrns<- 10^ems_adult2e_df$lower.HPD
ems_adult2e_df$upper.HPD.bktrns<- 10^ems_adult2e_df$upper.HPD


#posterior means for lat_cat*disease_time_step only
ems_adult2f<-emmeans(adult_count_mod2, ~lat_cat*disease_time_step)
summary(ems_adult2f, point.est = mean)

ems_adult2f_df<- as.data.frame(summary(ems_adult2f, point.est = mean))
ems_adult2f_df$emmean.bktrns<- 10^ems_adult2f_df$emmean
ems_adult2f_df$lower.HPD.bktrns<- 10^ems_adult2f_df$lower.HPD
ems_adult2f_df$upper.HPD.bktrns<- 10^ems_adult2f_df$upper.HPD




#posterior means for lat_cat*disease_time_step only
ems_adult2g<-emmeans(adult_count_mod2, ~disease_time_step)
summary(ems_adult2g, point.est = mean)

ems_adult2g_df<- as.data.frame(summary(ems_adult2g, point.est = mean))
ems_adult2g_df$emmean.bktrns<- 10^ems_adult2g_df$emmean
ems_adult2g_df$lower.HPD.bktrns<- 10^ems_adult2g_df$lower.HPD
ems_adult2g_df$upper.HPD.bktrns<- 10^ems_adult2g_df$upper.HPD
```

get full emmeans means and credible intervals for all female second model interaction combos (for Supplementary Table S2)
```{r}
#females
#get full posterior means for all combos
ems_fem2<-emmeans(fem_count_mod2, ~disease_time_step*lat_cat*repstat)
summary(ems_fem2, point.est = mean)

ems_fem2_df<- as.data.frame(summary(ems_fem2, point.est = mean))
ems_fem2_df$emmean.bktrns<- 10^ems_fem2_df$emmean
ems_fem2_df$lower.HPD.bktrns<- 10^ems_fem2_df$lower.HPD
ems_fem2_df$upper.HPD.bktrns<- 10^ems_fem2_df$upper.HPD

# get female posterior means by repstat and disease status for plotting purposes only
ems_fem2b<- emmeans(fem_count_mod2, ~repstat*disease_time_step)
summary(ems_fem2b, point.est = mean)

ems_fem2b_df<- as.data.frame(summary(ems_fem2b, point.est = mean))
ems_fem2b_df$emmean.bktrns<- 10^ems_fem2b_df$emmean
ems_fem2b_df$lower.HPD.bktrns<- 10^ems_fem2b_df$lower.HPD
ems_fem2b_df$upper.HPD.bktrns<- 10^ems_fem2b_df$upper.HPD


# get female posterior means by disease status only for results purposes 
ems_fem2c<- emmeans(fem_count_mod2, ~disease_time_step)
summary(ems_fem2c, point.est = mean)

ems_fem2c_df<- as.data.frame(summary(ems_fem2c, point.est = mean))
ems_fem2c_df$emmean.bktrns<- 10^ems_fem2c_df$emmean
ems_fem2c_df$lower.HPD.bktrns<- 10^ems_fem2c_df$lower.HPD
ems_fem2c_df$upper.HPD.bktrns<- 10^ems_fem2c_df$upper.HPD



ems_fem2d<- emmeans(fem_count_mod2, ~repstat*lat_cat)
summary(ems_fem2d, point.est = mean)

ems_fem2d_df<- as.data.frame(summary(ems_fem2d, point.est = mean))
ems_fem2d_df$emmean.bktrns<- 10^ems_fem2d_df$emmean
ems_fem2d_df$lower.HPD.bktrns<- 10^ems_fem2d_df$lower.HPD
ems_fem2d_df$upper.HPD.bktrns<- 10^ems_fem2d_df$upper.HPD


ems_fem2e<- emmeans(fem_count_mod2, ~disease_time_step*lat_cat)
summary(ems_fem2e, point.est = mean)

ems_fem2e_df<- as.data.frame(summary(ems_fem2e, point.est = mean))
ems_fem2e_df$emmean.bktrns<- 10^ems_fem2e_df$emmean
ems_fem2e_df$lower.HPD.bktrns<- 10^ems_fem2e_df$lower.HPD
ems_fem2e_df$upper.HPD.bktrns<- 10^ems_fem2e_df$upper.HPD



ems_fem2f<- emmeans(fem_count_mod2, ~lat_cat)
summary(ems_fem2f, point.est = mean)

ems_fem2f_df<- as.data.frame(summary(ems_fem2f, point.est = mean))
ems_fem2f_df$emmean.bktrns<- 10^ems_fem2f_df$emmean
ems_fem2f_df$lower.HPD.bktrns<- 10^ems_fem2f_df$lower.HPD
ems_fem2f_df$upper.HPD.bktrns<- 10^ems_fem2f_df$upper.HPD



ems_fem2g<- emmeans(fem_count_mod2, ~repstat)
summary(ems_fem2g, point.est = mean)

ems_fem2g_df<- as.data.frame(summary(ems_fem2g, point.est = mean))
ems_fem2g_df$emmean.bktrns<- 10^ems_fem2g_df$emmean
ems_fem2g_df$lower.HPD.bktrns<- 10^ems_fem2g_df$lower.HPD
ems_fem2g_df$upper.HPD.bktrns<- 10^ems_fem2g_df$upper.HPD

```


```{r}
#find the differences in the second adult and female models with contrasts
pairs(ems_adult2)

pairs(ems_fem2)
```


Figure 1
```{r}
#adult plot
adult_count_mod1_plot<-
  ggplot(data = adult_count_mod1_pred, aes(x= x, y = predicted, color = facet))+
  geom_line(data = adult_count_mod1_pred[adult_count_mod1_pred$facet == 'female' & adult_count_mod1_pred$group == 'pre-invasion', ], aes(x = x, y = predicted), color = 'lightpink1', linetype = 'solid', lwd = 1) +
  geom_line(data = adult_count_mod1_pred[adult_count_mod1_pred$facet == 'female' & adult_count_mod1_pred$group == 'invasion', ], aes(x = x, y = predicted), color = 'hotpink', linetype = 'solid', lwd = 1) +
  geom_line(data = adult_count_mod1_pred[adult_count_mod1_pred$facet == 'female' & adult_count_mod1_pred$group == 'epidemic', ], aes(x = x, y = predicted), color = 'violetred3', linetype = 'solid', lwd = 1) +
  geom_line(data = adult_count_mod1_pred[adult_count_mod1_pred$facet == 'female' & adult_count_mod1_pred$group == 'established', ], aes(x = x, y = predicted), color = 'violetred4', linetype = 'solid', lwd = 1) +
  geom_line(data = adult_count_mod1_pred[adult_count_mod1_pred$facet == 'male' & adult_count_mod1_pred$group == 'pre-invasion', ], aes(x = x, y = predicted), color = 'skyblue2', linetype = 'solid', lwd = 1) +
  geom_line(data = adult_count_mod1_pred[adult_count_mod1_pred$facet == 'male' & adult_count_mod1_pred$group == 'invasion', ], aes(x = x, y = predicted), color = 'dodgerblue', linetype = 'solid', lwd = 1) +
  geom_line(data = adult_count_mod1_pred[adult_count_mod1_pred$facet == 'male' & adult_count_mod1_pred$group == 'epidemic', ], aes(x = x, y = predicted), color = 'slateblue3', linetype = 'solid', lwd = 1) +
  geom_line(data = adult_count_mod1_pred[adult_count_mod1_pred$facet == 'male' & adult_count_mod1_pred$group == 'established', ], aes(x = x, y = predicted), color = 'midnightblue', linetype = 'solid', lwd = 1) +
  geom_ribbon(data = adult_count_mod1_pred[adult_count_mod1_pred$facet == 'female' & adult_count_mod1_pred$group == 'pre-invasion', ], aes(ymin= conf.low, ymax= conf.high), fill = 'lightpink1', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = adult_count_mod1_pred[adult_count_mod1_pred$facet == 'female' & adult_count_mod1_pred$group == 'invasion', ], aes(ymin= conf.low, ymax= conf.high), fill = 'hotpink', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = adult_count_mod1_pred[adult_count_mod1_pred$facet == 'female' & adult_count_mod1_pred$group == 'epidemic', ], aes(ymin= conf.low, ymax= conf.high), fill = 'violetred3', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = adult_count_mod1_pred[adult_count_mod1_pred$facet == 'female' & adult_count_mod1_pred$group == 'established', ], aes(ymin= conf.low, ymax= conf.high), fill = 'violetred4', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = adult_count_mod1_pred[adult_count_mod1_pred$facet == 'male' & adult_count_mod1_pred$group == 'pre-invasion', ], aes(ymin= conf.low, ymax= conf.high), fill = 'skyblue2', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = adult_count_mod1_pred[adult_count_mod1_pred$facet == 'male' & adult_count_mod1_pred$group == 'invasion', ], aes(ymin= conf.low, ymax= conf.high), fill = 'dodgerblue', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = adult_count_mod1_pred[adult_count_mod1_pred$facet == 'male' & adult_count_mod1_pred$group == 'epidemic', ], aes(ymin= conf.low, ymax= conf.high), fill = 'slateblue3', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = adult_count_mod1_pred[adult_count_mod1_pred$facet == 'male' & adult_count_mod1_pred$group == 'established', ], aes(ymin= conf.low, ymax= conf.high), fill = 'midnightblue', alpha = 0.3, linetype = 'blank') +
  new_scale_color() +
  geom_point(data = adult_count_mod1_pred[adult_count_mod1_pred$facet == 'female', ], aes(x= x, y = predicted, color = group, fill = group, shape = group), position = position_jitter()) +
  scale_color_manual(values = c('lightpink1', 'hotpink', 'violetred3', 'violetred4'))+
  new_scale_color() +
  geom_point(data = adult_count_mod1_pred[adult_count_mod1_pred$facet == 'male', ], aes(x= x, y = predicted, color = group, fill = group, shape = group), position = position_jitter()) +
  scale_color_manual(values = c('skyblue2', 'dodgerblue', 'slateblue3', 'midnightblue'))+
  geom_vline(xintercept = 39.5, lwd = 1.5) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"))+
  theme(legend.title = element_blank())+
  ylim(0, 3.5)+
  labs(x="Latitude", y= expression(paste("Predicted Adult ", italic("E. fuscus"), " Captures per Survey Night per Site")))

ggsave("adult_count_mod1_plot.png", adult_count_mod1_plot, bg = "transparent", width = 6, height = 4.5)




#female-only plot
fem_count_mod1_plot<-
  ggplot(data = fem_count_mod1_pred, aes(x= x, y = predicted, color = group))+
  geom_line(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'non-reproductive' & fem_count_mod1_pred$group == 'pre-invasion', ], aes(x = x, y = predicted), color = 'lightpink1', linetype = 'solid', lwd = 1) +
  geom_line(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'non-reproductive' & fem_count_mod1_pred$group == 'invasion', ], aes(x = x, y = predicted), color = 'hotpink', linetype = 'solid', lwd = 1) +
  geom_line(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'non-reproductive' & fem_count_mod1_pred$group == 'epidemic', ], aes(x = x, y = predicted), color = 'violetred3', linetype = 'solid', lwd = 1) +
  geom_line(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'non-reproductive' & fem_count_mod1_pred$group == 'established', ], aes(x = x, y = predicted), color = 'violetred4', linetype = 'solid', lwd = 1) +
  geom_line(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'pregnant' & fem_count_mod1_pred$group == 'pre-invasion', ], aes(x = x, y = predicted), color = 'lightpink1', linetype = 'dashed', lwd = 1) +
  geom_line(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'pregnant' & fem_count_mod1_pred$group == 'invasion', ], aes(x = x, y = predicted), color = 'hotpink', linetype = 'dashed', lwd = 1) +
  geom_line(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'pregnant' & fem_count_mod1_pred$group == 'epidemic', ], aes(x = x, y = predicted), color = 'violetred3', linetype = 'dashed', lwd = 1) +
  geom_line(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'pregnant' & fem_count_mod1_pred$group == 'established', ], aes(x = x, y = predicted), color = 'violetred4', linetype = 'dashed', lwd = 1) +
  geom_line(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'lactating' & fem_count_mod1_pred$group == 'pre-invasion', ], aes(x = x, y = predicted), color = 'lightpink1', linetype = 'dotted', lwd = 1) +
  geom_line(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'lactating' & fem_count_mod1_pred$group == 'invasion', ], aes(x = x, y = predicted), color = 'hotpink', linetype = 'dotted', lwd = 1) +
  geom_line(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'lactating' & fem_count_mod1_pred$group == 'epidemic', ], aes(x = x, y = predicted), color = 'violetred3', linetype = 'dotted', lwd = 1) +
  geom_line(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'lactating' & fem_count_mod1_pred$group == 'established', ], aes(x = x, y = predicted), color = 'violetred4', linetype = 'dotted', lwd = 1) +
  geom_line(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'post-lactating' & fem_count_mod1_pred$group == 'pre-invasion', ], aes(x = x, y = predicted), color = 'lightpink1', linetype = 'dotdash', lwd = 1) +
  geom_line(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'post-lactating' & fem_count_mod1_pred$group == 'invasion', ], aes(x = x, y = predicted), color = 'hotpink', linetype = 'dotdash', lwd = 1) +
  geom_line(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'post-lactating' & fem_count_mod1_pred$group == 'epidemic', ], aes(x = x, y = predicted), color = 'violetred3', linetype = 'dotdash', lwd = 1) +
  geom_line(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'post-lactating' & fem_count_mod1_pred$group == 'established', ], aes(x = x, y = predicted), color = 'violetred4', linetype = 'dotdash', lwd = 1) +
  geom_ribbon(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'non-reproductive' & fem_count_mod1_pred$group == 'pre-invasion', ], aes(ymin= conf.low, ymax= conf.high), fill = 'lightpink1', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'non-reproductive' & fem_count_mod1_pred$group == 'invasion', ], aes(ymin= conf.low, ymax= conf.high), fill = 'hotpink', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'non-reproductive' & fem_count_mod1_pred$group == 'epidemic', ], aes(ymin= conf.low, ymax= conf.high), fill = 'violetred3', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'non-reproductive' & fem_count_mod1_pred$group == 'established', ], aes(ymin= conf.low, ymax= conf.high), fill = 'violetred4', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'pregnant' & fem_count_mod1_pred$group == 'pre-invasion', ], aes(ymin= conf.low, ymax= conf.high), fill = 'lightpink1', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'pregnant' & fem_count_mod1_pred$group == 'invasion', ], aes(ymin= conf.low, ymax= conf.high), fill = 'hotpink', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'pregnant' & fem_count_mod1_pred$group == 'epidemic', ], aes(ymin= conf.low, ymax= conf.high), fill = 'violetred3', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'pregnant' & fem_count_mod1_pred$group == 'established', ], aes(ymin= conf.low, ymax= conf.high), fill = 'violetred4', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'lactating' & fem_count_mod1_pred$group == 'pre-invasion', ], aes(ymin= conf.low, ymax= conf.high), fill = 'lightpink1', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'lactating' & fem_count_mod1_pred$group == 'invasion', ], aes(ymin= conf.low, ymax= conf.high), fill = 'hotpink', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'lactating' & fem_count_mod1_pred$group == 'epidemic', ], aes(ymin= conf.low, ymax= conf.high), fill = 'violetred3', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'lactating' & fem_count_mod1_pred$group == 'established', ], aes(ymin= conf.low, ymax= conf.high), fill = 'violetred4', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'post-lactating' & fem_count_mod1_pred$group == 'pre-invasion', ], aes(ymin= conf.low, ymax= conf.high), fill = 'lightpink1', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'post-lactating' & fem_count_mod1_pred$group == 'invasion', ], aes(ymin= conf.low, ymax= conf.high), fill = 'hotpink', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'post-lactating' & fem_count_mod1_pred$group == 'epidemic', ], aes(ymin= conf.low, ymax= conf.high), fill = 'violetred3', alpha = 0.3, linetype = 'blank') +
  geom_ribbon(data = fem_count_mod1_pred[fem_count_mod1_pred$facet == 'post-lactating' & fem_count_mod1_pred$group == 'established', ], aes(ymin= conf.low, ymax= conf.high), fill = 'violetred4', alpha = 0.3, linetype = 'blank') +
  new_scale_color() +
  geom_point(data = fem_count_mod1_pred, aes(x= x, y = predicted, color = group, shape = facet), position = position_jitter()) +
  scale_color_manual(values = c('lightpink1', 'hotpink', 'violetred3', 'violetred4'))+
  geom_vline(xintercept = 39.5, lwd = 1.5) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"))+
  theme(legend.title = element_blank())+
  ylim(0, 3.5)+
  labs(x="Latitude", y= expression(paste("Predicted Female ", italic("E. fuscus"), " Captures per Survey Night per Site")))

Figure1<- adult_count_mod1_plot + fem_count_mod1_plot
Figure1

#femplot for legend
femLegend<- ggplot(data = fem_count_mod1_pred, aes(x = x, y = predicted, color = group, fill = group, linetype = facet, shape= facet))+
geom_point()+
geom_line()+
geom_ribbon(aes(ymin= conf.low, ymax= conf.high), alpha = 0.3) +
scale_color_manual(values = c('lightpink1', 'hotpink', 'violetred3', 'violetred4'))+
scale_fill_manual(values = c('lightpink1', 'hotpink', 'violetred3', 'violetred4'))+
scale_linetype_manual(values = c('solid', 'dashed', 'dotted', 'dotdash'))


ggsave("fem_count_mod1_plot.png", fem_count_mod1_plot, bg = "transparent", width = 6, height = 4.5)

ggsave("femLegend.png", femLegend, bg = "transparent", width = 6, height = 4.5)

#The adult and female-only plots were then placed side-by-side in Microsoft Powerpoint, and the female legend plot was cropped for the legend-only and replaced the female-only model plot legend.

```

Figure 2
```{r}
###NOTE: the only time there is a N/S split for the full adult secondary model is for males in invasion years, so we will not plot them by N/S but instead by sex
  
sexpre<- ggplot(data = draws_adult2[draws_adult2$disease_time_step == 'pre-invasion', ], aes(y = disease_time_step, x = .value_bktrns, fill = sex, color = sex)) +
  stat_halfeye(color = 'black', alpha = .7, aes(shape = sex)) +
  geom_vline(xintercept = 2.02, lwd = 1, color = 'gray')+
  annotate("rect", xmin = 1.81, xmax = 2.26, ymin = -Inf, ymax = Inf, fill = 'gray', alpha = 0.25) +
  scale_color_manual(values = c('violetred3', 'slateblue3')) +
  scale_fill_manual(values = c('violetred3', 'slateblue3')) +
  scale_y_discrete(expand = c(0.1, 0)) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(), axis.line.x = element_blank(), legend.position = "none", plot.title = element_text(hjust = 0.5))+
  xlim(1, 5) +
  labs(x=expression(paste("Estimated ", italic("E. fuscus"), " Captures per Survey Night per Site")), y= " ")

sexinv<- ggplot(data = draws_adult2[draws_adult2$disease_time_step == 'invasion', ], aes(y = disease_time_step, x = .value_bktrns, fill = sex, color = sex)) +
  stat_halfeye(color = 'black', alpha = .7, aes(shape = sex)) +
  geom_vline(xintercept = 2.02, lwd = 1, color = 'gray')+
  annotate("rect", xmin = 1.83, xmax = 2.24, ymin = -Inf, ymax = Inf, fill = 'gray', alpha = 0.25) +
  scale_color_manual(values = c('violetred3', 'slateblue3')) +
  scale_fill_manual(values = c('violetred3', 'slateblue3')) +
  scale_y_discrete(expand = c(0.1, 0)) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(), axis.line.x = element_blank(), legend.position = "none", plot.title = element_text(hjust = 0.5))+
  xlim(1, 5) +
  labs(x=expression(paste("Estimated ", italic("E. fuscus"), " Captures per Survey Night per Site")), y= " ")


sexepi<- ggplot(data = draws_adult2[draws_adult2$disease_time_step == 'epidemic', ], aes(y = disease_time_step, x = .value_bktrns, fill = sex, color = sex)) +
  stat_halfeye(color = 'black', alpha = .7, aes(shape = sex)) +
  geom_vline(xintercept = 1.96, lwd = 1, color = 'gray')+
  annotate("rect", xmin = 1.82, xmax = 2.11, ymin = -Inf, ymax = Inf, fill = 'gray', alpha = 0.25) +
  scale_color_manual(values = c('violetred3', 'slateblue3')) +
  scale_fill_manual(values = c('violetred3', 'slateblue3')) +
  scale_y_discrete(expand = c(0.1, 0)) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(), axis.line.x = element_blank(), legend.position = "none", plot.title = element_text(hjust = 0.5))+
  xlim(1, 5) +
  labs(x=expression(paste("Estimated ", italic("E. fuscus"), " Captures per Survey Night per Site")), y= " ")


sexest<- ggplot(data = draws_adult2[draws_adult2$disease_time_step == 'established', ], aes(y = disease_time_step, x = .value_bktrns, fill = sex, color = sex)) +
  stat_halfeye(color = 'black', alpha = .7, aes(shape = sex)) +
  geom_vline(xintercept = 2.94, lwd = 1, color = 'gray')+
  annotate("rect", xmin = 2.70, xmax = 3.19, ymin = -Inf, ymax = Inf, fill = 'gray', alpha = 0.25) +
  scale_color_manual(values = c('violetred3', 'slateblue3')) +
  scale_fill_manual(values = c('violetred3', 'slateblue3')) +
  scale_y_discrete(expand = c(0.1, 0)) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"), plot.title = element_text(hjust = 0.5))+
  xlim(1, 5) +
  labs(x=expression(paste("Estimated ", italic("E. fuscus"), " Captures per Survey Night per Site")), y= " ")




Figure2<- sexpre/sexinv/sexepi/sexest
Figure2
```


Figure 3
```{r}

NRpre<- ggplot(data = draws_fem2[draws_fem2$disease_time_step == 'pre-invasion' & draws_fem2$repstat == 'non-reproductive', ], aes(y = disease_time_step, x = .value_bktrns, fill = lat_cat, color = lat_cat)) +
  stat_halfeye(color = 'black', alpha = .7, aes(shape = lat_cat)) +
  geom_vline(xintercept = 2.24, lwd = 1, color = 'gray')+
  annotate("rect", xmin = 1.08, xmax = 2.84, ymin = -Inf, ymax = Inf, fill = 'gray', alpha = 0.25) +
  scale_color_manual(values = c('darkcyan', 'coral3')) +
  scale_fill_manual(values = c('darkcyan', 'coral3')) +
  scale_y_discrete(expand = c(0.1, 0)) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(), axis.line.x = element_blank(), legend.position = "none", plot.title = element_text(hjust = 0.5))+
  xlim(0, 13) +
  labs(x=expression(paste("Estimated Female ", italic("E. fuscus"), " Captures per Survey Night per Site")), y= " ")


NRinv<- ggplot(data = draws_fem2[draws_fem2$disease_time_step == 'invasion' & draws_fem2$repstat == 'non-reproductive', ], aes(y = disease_time_step, x = .value_bktrns, fill = lat_cat, color = lat_cat)) +
  stat_halfeye(color = 'black', alpha = .7, aes(shape = lat_cat)) +
  geom_vline(xintercept = 2.35, lwd = 1, color = 'gray')+
  annotate("rect", xmin = 1.87, xmax = 2.99, ymin = -Inf, ymax = Inf, fill = 'gray', alpha = 0.25) +
  scale_color_manual(values = c('darkcyan', 'coral3')) +
  scale_fill_manual(values = c('darkcyan', 'coral3')) +
  scale_y_discrete(expand = c(0.1, 0)) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(), axis.line.x = element_blank(), legend.position = "none")+
 xlim(0, 13) +
  labs(x=expression(paste("Estimated Female ", italic("E. fuscus"), " Captures per Survey Night per Site")), y= " ")

NRepi<- ggplot(data = draws_fem2[draws_fem2$disease_time_step == 'epidemic' & draws_fem2$repstat == 'non-reproductive', ], aes(y = disease_time_step, x = .value_bktrns, fill = lat_cat, color = lat_cat)) +
  stat_halfeye(color = 'black', alpha = .7, aes(shape = lat_cat)) +
  geom_vline(xintercept = 1.81, lwd = 1, color = 'gray')+
  annotate("rect", xmin = 1.53, xmax = 2.17, ymin = -Inf, ymax = Inf, fill = 'gray', alpha = 0.25) +
  scale_color_manual(values = c('darkcyan', 'coral3')) +
  scale_fill_manual(values = c('darkcyan', 'coral3')) +  
  scale_y_discrete(expand = c(0.1, 0)) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(), axis.line.x = element_blank(), legend.position = "none")+
  xlim(0, 13) +
  labs(x=expression(paste("Estimated Female ", italic("E. fuscus"), " Captures per Survey Night per Site")), y= " ")

NRest<- ggplot(data = draws_fem2[draws_fem2$disease_time_step == 'established' & draws_fem2$repstat == 'non-reproductive', ], aes(y = disease_time_step, x = .value_bktrns, fill = lat_cat, color = lat_cat)) +
  stat_halfeye(color = 'black', alpha = .7, aes(shape = lat_cat)) +
  geom_vline(xintercept = 2.50, lwd = 1, color = 'gray')+
  annotate("rect", xmin = 2.07, xmax = 3.02, ymin = -Inf, ymax = Inf, fill = 'gray', alpha = 0.25) +
  scale_color_manual(values = c('darkcyan', 'coral3')) +
  scale_fill_manual(values = c('darkcyan', 'coral3')) +
  scale_y_discrete(expand = c(0.1, 0)) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"), legend.position = "none")+
  xlim(0, 13) +
  labs(x=expression(paste("Estimated Female ", italic("E. fuscus"), " Captures per Survey Night per Site")), y= " ")

NRall<- NRpre/NRinv/NRepi/NRest
ggsave("NRall.png", NRall, bg = "transparent", width = 9, height = 4)


Ppre<- ggplot(data = draws_fem2[draws_fem2$disease_time_step == 'pre-invasion' & draws_fem2$repstat == 'pregnant', ], aes(y = disease_time_step, x = .value_bktrns, fill = lat_cat, color = lat_cat)) +
  stat_halfeye(color = 'black', alpha = .7, aes(shape = lat_cat)) +
  geom_vline(xintercept = 2.91, lwd = 1, color = 'gray')+
  annotate("rect", xmin = 2.17, xmax = 3.90, ymin = -Inf, ymax = Inf, fill = 'gray', alpha = 0.25) +
  scale_color_manual(values = c('darkcyan', 'coral3')) +
  scale_fill_manual(values = c('darkcyan', 'coral3')) +
  scale_y_discrete(expand = c(0.1, 0)) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(), axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(), legend.position = "none", plot.title = element_text(hjust = 0.5))+
  xlim(0, 13) +
  labs(x=expression(paste("Estimated Female ", italic("E. fuscus"), " Captures per Survey Night per Site")), y= " ")


Pinv<- ggplot(data = draws_fem2[draws_fem2$disease_time_step == 'invasion' & draws_fem2$repstat == 'pregnant', ], aes(y = disease_time_step, x = .value_bktrns, fill = lat_cat, color = lat_cat)) +
  stat_halfeye(color = 'black', alpha = .7, aes(shape = lat_cat)) +
  geom_vline(xintercept = 3.68, lwd = 1, color = 'gray')+
  annotate("rect", xmin = 2.83, xmax = 4.87, ymin = -Inf, ymax = Inf, fill = 'gray', alpha = 0.25) +
  scale_color_manual(values = c('darkcyan', 'coral3')) +
  scale_fill_manual(values = c('darkcyan', 'coral3')) +
  scale_y_discrete(expand = c(0.1, 0)) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(), axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(), legend.position = "none", plot.title = element_text(hjust = 0.5))+
  xlim(0, 13) +
  labs(x=expression(paste("Estimated Female ", italic("E. fuscus"), " Captures per Survey Night per Site")), y= " ")

Pepi<- ggplot(data = draws_fem2[draws_fem2$disease_time_step == 'epidemic' & draws_fem2$repstat == 'pregnant', ], aes(y = disease_time_step, x = .value_bktrns, fill = lat_cat, color = lat_cat)) +
  stat_halfeye(color = 'black', alpha = .7, aes(shape = lat_cat)) +
  geom_vline(xintercept = 4.17, lwd = 1, color = 'gray')+
  annotate("rect", xmin = 3.45, xmax = 4.99, ymin = -Inf, ymax = Inf, fill = 'gray', alpha = 0.25) +
  scale_color_manual(values = c('darkcyan', 'coral3')) +
  scale_fill_manual(values = c('darkcyan', 'coral3')) +
  scale_y_discrete(expand = c(0.1, 0)) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(), axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(), legend.position = "none", plot.title = element_text(hjust = 0.5))+
  xlim(0, 13) +
  labs(x=expression(paste("Estimated Female ", italic("E. fuscus"), " Captures per Survey Night per Site")), y= " ")

Pest<- ggplot(data = draws_fem2[draws_fem2$disease_time_step == 'established' & draws_fem2$repstat == 'pregnant', ], aes(y = disease_time_step, x = .value_bktrns, fill = lat_cat, color = lat_cat)) +
  stat_halfeye(color = 'black', alpha = .7, aes(shape = lat_cat)) +
  geom_vline(xintercept = 5.11, lwd = 1, color = 'gray')+
  annotate("rect", xmin = 3.99, xmax = 6.44, ymin = -Inf, ymax = Inf, fill = 'gray', alpha = 0.25) +
  scale_color_manual(values = c('darkcyan', 'coral3')) +
  scale_fill_manual(values = c('darkcyan', 'coral3')) +
  scale_y_discrete(expand = c(0.1, 0)) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"), axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(), legend.position = "none", plot.title = element_text(hjust = 0.5))+
 xlim(0, 13) +
  labs(x=expression(paste("Estimated Female ", italic("E. fuscus"), " Captures per Survey Night per Site")), y= " ")




Lpre<- ggplot(data = draws_fem2[draws_fem2$disease_time_step == 'pre-invasion' & draws_fem2$repstat == 'lactating', ], aes(y = disease_time_step, x = .value_bktrns, fill = lat_cat, color = lat_cat)) +
  stat_halfeye(color = 'black', alpha = .7, aes(shape = lat_cat)) +
  geom_vline(xintercept = 5.02, lwd = 1, color = 'gray')+
  annotate("rect", xmin = 3.98, xmax = 6.24, ymin = -Inf, ymax = Inf, fill = 'gray', alpha = 0.25) +
  scale_color_manual(values = c('darkcyan', 'coral3')) +
  scale_fill_manual(values = c('darkcyan', 'coral3')) +
  scale_y_discrete(expand = c(0.1, 0)) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(), axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(), legend.position = "none", plot.title = element_text(hjust = 0.5))+
  xlim(0, 13) +
  labs(x=expression(paste("Estimated Female ", italic("E. fuscus"), " Captures per Survey Night per Site")), y= " ")


Linv<- ggplot(data = draws_fem2[draws_fem2$disease_time_step == 'invasion' & draws_fem2$repstat == 'lactating', ], aes(y = disease_time_step, x = .value_bktrns, fill = lat_cat, color = lat_cat)) +
  stat_halfeye(color = 'black', alpha = .7, aes(shape = lat_cat)) +
  geom_vline(xintercept = 5.73, lwd = 1, color = 'gray')+
  annotate("rect", xmin = 4.70, xmax = 6.97, ymin = -Inf, ymax = Inf, fill = 'gray', alpha = 0.25) +
  scale_color_manual(values = c('darkcyan', 'coral3')) +
  scale_fill_manual(values = c('darkcyan', 'coral3')) +
  scale_y_discrete(expand = c(0.1, 0)) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(), axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(), legend.position = "none", plot.title = element_text(hjust = 0.5))+
  xlim(0, 13) +
  labs(x=expression(paste("Estimated Female ", italic("E. fuscus"), " Captures per Survey Night per Site")), y= " ")

Lepi<- ggplot(data = draws_fem2[draws_fem2$disease_time_step == 'epidemic' & draws_fem2$repstat == 'lactating', ], aes(y = disease_time_step, x = .value_bktrns, fill = lat_cat, color = lat_cat)) +
  stat_halfeye(color = 'black', alpha = .7, aes(shape = lat_cat)) +
  geom_vline(xintercept = 4.53, lwd = 1, color = 'gray')+
  annotate("rect", xmin = 3.92, xmax = 5.23, ymin = -Inf, ymax = Inf, fill = 'gray', alpha = 0.25) +
  scale_color_manual(values = c('darkcyan', 'coral3')) +
  scale_fill_manual(values = c('darkcyan', 'coral3')) +
  scale_y_discrete(expand = c(0.1, 0)) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(), axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(), legend.position = "none", plot.title = element_text(hjust = 0.5))+
  xlim(0, 13) +
  labs(x=expression(paste("Estimated Female ", italic("E. fuscus"), " Captures per Survey Night per Site")), y= " ")

Lest<- ggplot(data = draws_fem2[draws_fem2$disease_time_step == 'established' & draws_fem2$repstat == 'lactating', ], aes(y = disease_time_step, x = .value_bktrns, fill = lat_cat, color = lat_cat)) +
  stat_halfeye(color = 'black', alpha = .7, aes(shape = lat_cat)) +
  geom_vline(xintercept = 6.64, lwd = 1, color = 'gray')+
  annotate("rect", xmin = 5.63, xmax = 7.77, ymin = -Inf, ymax = Inf, fill = 'gray', alpha = 0.25) +
  scale_color_manual(values = c('darkcyan', 'coral3')) +
  scale_fill_manual(values = c('darkcyan', 'coral3')) +
  scale_y_discrete(expand = c(0.1, 0)) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"), axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(), legend.position = "none", plot.title = element_text(hjust = 0.5))+
  xlim(0, 13) +
  labs(x=expression(paste("Estimated Female ", italic("E. fuscus"), " Captures per Survey Night per Site")), y= " ")



PLpre<- ggplot(data = draws_fem2[draws_fem2$disease_time_step == 'pre-invasion' & draws_fem2$repstat == 'post-lactating', ], aes(y = disease_time_step, x = .value_bktrns, fill = lat_cat, color = lat_cat)) +
  stat_halfeye(color = 'black', alpha = .7, aes(shape = lat_cat)) +
  geom_vline(xintercept = 3.54, lwd = 1, color = 'gray')+
  annotate("rect", xmin = 2.88, xmax = 4.34, ymin = -Inf, ymax = Inf, fill = 'gray', alpha = 0.25) +
  scale_color_manual(values = c('darkcyan', 'coral3')) +
  scale_fill_manual(values = c('darkcyan', 'coral3')) +
  scale_y_discrete(expand = c(0.1, 0)) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(), axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(), legend.position = "none", plot.title = element_text(hjust = 0.5))+
  xlim(0, 13) +
  labs(x=expression(paste("Estimated Female ", italic("E. fuscus"), " Captures per Survey Night per Site")), y= " ")


PLinv<- ggplot(data = draws_fem2[draws_fem2$disease_time_step == 'invasion' & draws_fem2$repstat == 'post-lactating', ], aes(y = disease_time_step, x = .value_bktrns, fill = lat_cat, color = lat_cat)) +
  stat_halfeye(color = 'black', alpha = .7, aes(shape = lat_cat)) +
  geom_vline(xintercept = 5.18, lwd = 1, color = 'gray')+
  annotate("rect", xmin = 4.31, xmax = 6.27, ymin = -Inf, ymax = Inf, fill = 'gray', alpha = 0.25) +
  scale_color_manual(values = c('darkcyan', 'coral3')) +
  scale_fill_manual(values = c('darkcyan', 'coral3')) +
  scale_y_discrete(expand = c(0.1, 0)) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(), axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(), plot.title = element_text(hjust = 0.5))+
  xlim(0, 13) +
  labs(x=expression(paste("Estimated Female ", italic("E. fuscus"), " Captures per Survey Night per Site")), y= " ")

PLepi<- ggplot(data = draws_fem2[draws_fem2$disease_time_step == 'epidemic' & draws_fem2$repstat == 'post-lactating', ], aes(y = disease_time_step, x = .value_bktrns, fill = lat_cat, color = lat_cat)) +
  stat_halfeye(color = 'black', alpha = .7, aes(shape = lat_cat)) +
  geom_vline(xintercept = 4.00, lwd = 1, color = 'gray')+
  annotate("rect", xmin = 3.45, xmax = 4.64, ymin = -Inf, ymax = Inf, fill = 'gray', alpha = 0.25) +
  scale_color_manual(values = c('darkcyan', 'coral3')) +
  scale_fill_manual(values = c('darkcyan', 'coral3')) +
  scale_y_discrete(expand = c(0.1, 0)) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"), axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(), axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(), legend.position = "none", plot.title = element_text(hjust = 0.5))+
  xlim(0, 13) +
  labs(x=expression(paste("Estimated Female ", italic("E. fuscus"), " Captures per Survey Night per Site")), y= " ")

PLest<- ggplot(data = draws_fem2[draws_fem2$disease_time_step == 'established' & draws_fem2$repstat == 'post-lactating', ], aes(y = disease_time_step, x = .value_bktrns, fill = lat_cat, color = lat_cat)) +
  stat_halfeye(color = 'black', alpha = .7, aes(shape = lat_cat)) +
  geom_vline(xintercept = 6.83, lwd = 1, color = 'gray')+
  annotate("rect", xmin = 5.72, xmax = 8.12, ymin = -Inf, ymax = Inf, fill = 'gray', alpha = 0.25) +
  scale_color_manual(values = c('darkcyan', 'coral3')) +
  scale_fill_manual(values = c('darkcyan', 'coral3')) +
  scale_y_discrete(expand = c(0.1, 0)) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"), axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(), legend.position = "none", plot.title = element_text(hjust = 0.5))+
  xlim(0, 13) +
  labs(x=expression(paste("Estimated Female ", italic("E. fuscus"), " Captures per Survey Night per Site")), y= " ")


Figure3<- (NRpre/NRinv/NRepi/NRest) | (Ppre/Pinv/Pepi/Pest) | (Lpre/Linv/Lepi/Lest) | (PLpre/PLinv/PLepi/PLest) + plot_layout(guides = 'collect')

Figure3
```


Figure S1
```{r}
#remove scientific notation defaults
options(scipen=10000)

#get adult data for individual dataset
adult_EPFU_data<- EPFU_data[EPFU_data$age == 'adult', ]

cap_by_month<- as.data.frame(table(adult_EPFU_data$month))
names(cap_by_month)<- c('month', 'count')
cap_by_month$month_name<- factor(cap_by_month$month_name, levels = c('March', 'April', 'May', 'June', 'July', 'August', 'September', 'October'))

#plot captures per month for adult EPFU
ggplot(data = cap_by_month, aes(x = month_name, y = count, color = month, fill = month)) + 
  geom_bar(stat = 'identity') + 
  geom_text(aes(label = count), vjust = -0.2) +
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_rect(fill = "transparent", colour = NA),
        plot.background = element_rect(fill = "transparent", colour = NA),
        legend.background = element_rect(fill = "transparent", colour = NA), 
        legend.box.background = element_rect(fill = "transparent", colour = NA), 
        legend.key = element_rect(fill = "transparent", colour = NA),
        axis.line = element_line(colour = "black"))+
  theme(legend.title = element_blank(), legend.position = 'none')+
  labs(x="Month of Capture", y= expression(paste("Total Number of Adult ", italic("E. fuscus"), " Captured")))
  
```

